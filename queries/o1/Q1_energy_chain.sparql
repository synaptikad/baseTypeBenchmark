PREFIX btb: <http://basetype.benchmark/ontology#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>

# Q1: Energy Chain - Traverse from meter through FEEDS chain
# Benchmark: RDF property path traversal
# Parameter: $METER_ID - starting meter for energy chain traversal

SELECT ?target ?type ?name ?depth
WHERE {
  # Start from specified meter
  BIND(<http://basetype.benchmark/$METER_ID> AS ?meter)

  # Traverse FEEDS chain (1-10 hops)
  ?meter btb:feeds+ ?target .
  ?target rdf:type ?type .

  OPTIONAL { ?target btb:name ?name }
}
ORDER BY ?type
