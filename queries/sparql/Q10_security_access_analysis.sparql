PREFIX btb: <http://basetype.benchmark/ontology#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>

# Q10: Security Access Analysis

SELECT ?zone_id ?zone_name ?building_id
       (COUNT(DISTINCT ?ap) AS ?access_point_count)
       (COUNT(DISTINCT ?eq) AS ?security_equipment_count)
WHERE {
  ?zone rdf:type btb:Zone ;
        btb:id ?zone_id ;
        btb:name ?zone_name ;
        btb:building_id ?building_id .

  OPTIONAL {
    ?zone btb:contains ?ap .
    ?ap rdf:type btb:AccessPoint .
  }

  OPTIONAL {
    ?zone ?rel ?eq .
    ?eq rdf:type btb:Equipment .
  }
}
GROUP BY ?zone_id ?zone_name ?building_id
ORDER BY DESC(?access_point_count) DESC(?security_equipment_count)
LIMIT 50
